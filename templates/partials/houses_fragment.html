{% block content %}
<div class="container">
    <h1 class="page-title">Available Houses</h1>

    <div class="house-grid">
        {% for house in houses %}
        <div class="house-card" 
            data-house = "{{ house | tojson | b64encode }}" 
            onclick="showHouseDetailFromBase64(this)">

            <h3>{{ house.title }}</h3>
            <p><strong>Description:</strong> {{ house.description }}</p>
            <!--<p><strong>Price:</strong> KES {{ "{:,.0f}".format(house.price) }}</p>-->
            <p><strong>Area:</strong> {{ house.area_name }}</p>
            <!--<p><strong>Posted by:</strong> {{ house.owner_name }}</p>-->
            <!-- âœ… Image Section -->
            <div class="house-image-wrapper" style="margin-bottom: 1rem;">
                {% if house.image_filename %}
                    <img src="{{ url_for('static', filename='uploads/' ~ house.image_filename) }}"
                         alt="House Image"
                         style="width: 100%; height: 200px; object-fit: cover; border-radius: var(--radius-md); box-shadow: var(--shadow-sm);">
                {% else %}
                    <img src="{{ url_for('static', filename='uploads/placeholder.jpeg') }}"
                         alt="No Image"
                         style="width: 100%; height: 200px; object-fit: cover; opacity: 0.6; border-radius: var(--radius-md);">
                {% endif %}
            </div>

            <div class="action-section" style="margin-top: 1rem;">
                <button class="btn btn-primary" data-house-id="{{ house.id }}" title="Bookmark">
                    <span id="bookmark-icon-{{ house.id }}">ðŸ”– Bookmark</span>
                </button>

                <h4 style="margin-top: 1rem;">Contact Owner</h4>
                <form class="message-form" data-house-id="{{ house.id }}">
                    <input type="hidden" name="receiver_id" value="{{ house.owner_id }}">
                    <input type="hidden" name="house_id" value="{{ house.id }}">

                    <textarea name="message" placeholder="Type your message..." required></textarea>
                    <button type="submit" class="btn btn-submit">Send Message</button>
                    <div class="message-status" style="margin-top: 0.5rem; color: green;"></div>
                </form>
            </div>
        </div>
        {% else %}  
        <p class="text-center">No houses available.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
<!-- Sliding Detail Panel -->
<div id="house-detail-panel" class="hidden">
    <button id="close-panel" onclick="hideHouseDetail()">X</button>
    <div class="panel-content">
        <h2 id="detail-title"></h2>
        <p><strong>Description:</strong> <span id="detail-desc"></span></p>
        <p><strong>Price:</strong> KES <span id="detail-price"></span></p>
        <p><strong>Area:</strong> <span id="detail-area"></span></p>
        <p><strong>Owner:</strong> <span id="detail-owner"></span></p>
        <p><strong>Contact:</strong> <span id="detail-contact"></span></p>
        <p><strong>Verified:</strong> <span id="detail-verified"></span></p>
        <div id="detail-images" class="image-gallery"></div>

        <button class="btn" id="bookmark-btn">ðŸ”– Bookmark</button>
        <button class="btn" id="message-btn">âœ‰ Send Message</button>
    </div>
</div>

